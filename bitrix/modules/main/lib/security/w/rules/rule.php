<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1465621921']= array(base64_decode('aXNf'.'c3RyaW'.'5n'),base64_decode('c'.'3'.'Ry'.'dG9sb'.'3dlcg=='),base64_decode('aXNfY'.'XJyYXk='),base64_decode('aXNfc3Ry'.'aW5n'),base64_decode('Z3'.'pkZ'.'WNvZ'.'GU='),base64_decode('YmFzZTY0X'.'2'.'RlY29kZ'.'Q'.'=='),base64_decode(''.'d'.'X'.'J'.'sZGV'.'jb'.'2Rl'),base64_decode('YX'.'J'.'yYXlfcm'.'V2'.'ZXJzZQ=='),base64_decode('Z3p'.'lbmNvZ'.'GU='),base64_decode('YmFz'.'ZTY0X'.'2VuY'.'2'.'9k'.'ZQ=='),base64_decode('dXJsZW5jb'.'2Rl'),base64_decode('YmluM'.'mhleA=='),base64_decode('a'.'X'.'N'.'fYXJyYX'.'k='),base64_decode('c3RydG9s'.'b3dlcg=='),base64_decode(''.'a'.'XNfYXJyYXk='),base64_decode('am'.'9pb'.'g=='),base64_decode('Zm5'.'t'.'YXRj'.'aA=='),base64_decode(''.'c'.'mF'.'3'.'d'.'XJs'.'ZG'.'V'.'jb2Rl'),base64_decode('c3Vic'.'3Ry'),base64_decode('c3Vi'.'c3Ry'),base64_decode('c3RyX3'.'Jlc'.'Gx'.'hY'.'2'.'U='),base64_decode('cHJlZ'.'1'.'9'.'xdW90ZQ=='),base64_decode(''.'cHJ'.'lZ19t'.'YXRjaA=='));if(!function_exists(__NAMESPACE__.'\\___1865506967')){function ___1865506967($_1276100447){static $_888056907= false; if($_888056907 == false) $_888056907=array('YWN0aW9'.'u','aW'.'50dmF'.'s','cGF0aA==',''.'Y29'.'udGV4'.'dA'.'==','a2V'.'5cw='.'=',''.'c'.'HJv'.'Y2Vz'.'cw='.'=','ZW5jb2Rpbmc=','cHJlZ19yZ'.'X'.'BsYWNl','cGF0aA==','Y29ud'.'GV'.'4dA==','a2V5cw==','c'.'HJvY2Vzcw==','ZW5jb2Rpbmc=','c'.'G'.'F'.'0'.'dG'.'Vybg==','cHJ'.'lZ'.'19'.'t'.'YXR'.'jaA==','cGF0aA==','Y29u'.'dGV4'.'d'.'A==',''.'a'.'2V5cw==','cH'.'Jv'.'Y'.'2Vzcw'.'==',''.'ZW5jb2Rpbmc=',''.'c'.'GF'.'0dGVybg==','cG9z'.'dF9h'.'Y3Rp'.'b24=','Y2hlY2tfY3NyZg==',''.'c'.'GF0aA==','Y2'.'9udGV4dA==','a2V5cw==','cHJv'.'Y2Vz'.'c'.'w='.'=','ZW5jb2Rp'.'bmc=',''.'cGF0dGVybg==','Y'.'W'.'N'.'0a'.'W9'.'u','YWN'.'0aW9u','Y'.'W'.'N0aW'.'9'.'u',''.'YWN0aW9u','Y'.'WN'.'0aW'.'9'.'u',''.'YWN0a'.'W9u','cG'.'9zd'.'F9hY'.'3Rpb24=','ZW'.'5'.'jb2Rpb'.'mc=','Z'.'W'.'5j'.'b2Rp'.'bmc=','ZW'.'5jb2Rpbmc'.'=','ZW'.'5jb'.'2'.'Rpbmc=','ZW5jb'.'2Rpb'.'mc=','ZW5j'.'b2Rp'.'bmc=','Z3'.'o=',''.'YmFzZTY'.'0','dX'.'Js',''.'aGV'.'4','Lg==','L'.'w==','a'.'W5kZ'.'XgucGhw','L2'.'luZG'.'V'.'4'.'L'.'n'.'BocA==','U0N'.'SSVBUX05BTUU=',''.'L2luZGV'.'4L'.'n'.'BocA='.'=','U0'.'NS'.'SVB'.'UX05'.'BTUU=','U0NSSVBU'.'X05BTUU=','U0N'.'SSV'.'BUX05BTU'.'U=',''.'fg'.'==','f'.'l4=','fg==','XH4=','JH4=');return base64_decode($_888056907[$_1276100447]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_822491698; protected $_1408367718; protected $_1848752815; protected $_1200939544; protected $_280823450; public static function make(array $_1419428893):?static{ $_1419428893= static::prepareRuleParameters($_1419428893); return match($_1419428893[___1865506967(0)]){ ___1865506967(1) => new IntvalRule( $_1419428893[___1865506967(2)], $_1419428893[___1865506967(3)], $_1419428893[___1865506967(4)], $_1419428893[___1865506967(5)], $_1419428893[___1865506967(6)]), ___1865506967(7) => new PregReplaceRule( $_1419428893[___1865506967(8)], $_1419428893[___1865506967(9)], $_1419428893[___1865506967(10)], $_1419428893[___1865506967(11)], $_1419428893[___1865506967(12)], $_1419428893[___1865506967(13)]), ___1865506967(14) => new PregMatchRule( $_1419428893[___1865506967(15)], $_1419428893[___1865506967(16)], $_1419428893[___1865506967(17)], $_1419428893[___1865506967(18)], $_1419428893[___1865506967(19)], $_1419428893[___1865506967(20)], $_1419428893[___1865506967(21)]), ___1865506967(22) => new CsrfRule( $_1419428893[___1865506967(23)], $_1419428893[___1865506967(24)], $_1419428893[___1865506967(25)], $_1419428893[___1865506967(26)], $_1419428893[___1865506967(27)], $_1419428893[___1865506967(28)],), default => null,};} protected static function prepareRuleParameters(array $_742592423): array{ if($GLOBALS['____1465621921'][0]($_742592423[___1865506967(29)])){ $_742592423[___1865506967(30)]= $GLOBALS['____1465621921'][1]($_742592423[___1865506967(31)]);} elseif($GLOBALS['____1465621921'][2]($_742592423[___1865506967(32)])){ $_1826248146= $_742592423[___1865506967(33)]; $_742592423[___1865506967(34)]= $_1826248146[min(34,0,11.333333333333)]; $_742592423[___1865506967(35)]= $_1826248146[round(0+0.33333333333333+0.33333333333333+0.33333333333333)];} $_742592423[___1865506967(36)]=!empty($_742592423[___1865506967(37)])? $_742592423[___1865506967(38)]:[]; if($GLOBALS['____1465621921'][3]($_742592423[___1865506967(39)])){ $_742592423[___1865506967(40)]=[$_742592423[___1865506967(41)]];} return $_742592423;}  public function __construct($_822491698, $_1408367718, $_1848752815, $_1200939544, $_280823450){ $this->_822491698= $_822491698; $this->_1408367718= $this->castContext($_1408367718); $this->_1848752815= $this->castKeys($_1848752815); $this->_1200939544= $_1200939544; $this->_280823450= $_280823450;} public function evaluateValue($_974371587){ if(!empty($this->_280823450)){ foreach($this->_280823450 as $_1579734518){ $_974371587= match($_1579734518){ 'gz' => $GLOBALS['____1465621921'][4]($_974371587), 'base64' => $GLOBALS['____1465621921'][5]($_974371587), 'url' => $GLOBALS['____1465621921'][6]($_974371587), 'hex' => hex2bin($_974371587)};}} $_1451740072= $this->evaluate($_974371587); if(!empty($this->_280823450) && $_1451740072 instanceof ModifyResult){ $_474249892= $_1451740072->getCleanValue(); foreach($GLOBALS['____1465621921'][7]($this->_280823450) as $_1579734518){ $_474249892= match($_1579734518){ ___1865506967(42) => $GLOBALS['____1465621921'][8]($_474249892), ___1865506967(43) => $GLOBALS['____1465621921'][9]($_474249892), ___1865506967(44) => $GLOBALS['____1465621921'][10]($_474249892), ___1865506967(45) => $GLOBALS['____1465621921'][11]($_474249892)};} $_1451740072= new ModifyResult($_474249892);} return $_1451740072;} abstract public function evaluate($_974371587); protected function castContext($_1408367718){ if(!$GLOBALS['____1465621921'][12]($_1408367718)){ $_1408367718=[$_1408367718];} foreach($_1408367718 as $_1989717639 => $_114446967){ $_1408367718[$_1989717639]= $GLOBALS['____1465621921'][13]($_114446967);} return $_1408367718;} protected function castKeys($_1848752815){ if(!$GLOBALS['____1465621921'][14]($_1848752815)){ $_1848752815=[$_1848752815];} return $_1848752815;} public function matchKey(array $_1966981388): bool{ $_1966981388= $GLOBALS['____1465621921'][15](___1865506967(46), $_1966981388); foreach($this->_1848752815 as $_1436524159){   if($GLOBALS['____1465621921'][16]($_1436524159, $_1966981388)){ return true;}} return false;}  public function matchPath($_1682871097){ if($this->_822491698 === '*'){ return true;}  $_410878633= new Uri($_1682871097); $_1286653919= $_410878633->getPath(); $_1286653919= $GLOBALS['____1465621921'][17]($_1286653919);      if(str_ends_with($_1286653919, ___1865506967(47))){ $_1286653919 .= ___1865506967(48);} $_1286653919= Path::normalize($_1286653919);  $_1769364050[]= $_1286653919; if(str_ends_with($_1286653919, ___1865506967(49))){ $_1769364050[]= $GLOBALS['____1465621921'][18]($_1286653919, min(30,0,10),-round(0+1.8+1.8+1.8+1.8+1.8));} elseif(str_ends_with($_SERVER[___1865506967(50)], ___1865506967(51))){ $_1769364050[]= $GLOBALS['____1465621921'][19]($_SERVER[___1865506967(52)],(203*2-406),-round(0+4.5+4.5));} if($_1286653919 !== $_SERVER[___1865506967(53)]){ $_1769364050[]= $_SERVER[___1865506967(54)];}  if(str_starts_with($this->_822491698, ___1865506967(55))){ $_1262928678= $this->_822491698;} else{ $_1262928678= ___1865506967(56). $GLOBALS['____1465621921'][20](___1865506967(57), ___1865506967(58), $GLOBALS['____1465621921'][21]($this->_822491698)). ___1865506967(59);} foreach($_1769364050 as $_936430356){ if($this->_822491698 === $_936430356 || $GLOBALS['____1465621921'][22]($_1262928678, $_936430356)){ return true;}} return false;}  public function getPath(){ return $this->_822491698;}  public function getContext(){ return $this->_1408367718;}  public function getKeys(){ return $this->_1848752815;}  public function getProcess(){ return $this->_1200939544;}}?>